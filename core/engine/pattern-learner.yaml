# SAGE Pattern Learner Specification
# Language-agnostic specification for pattern recognition, success metrics, and learning configuration

version: "1.0.0"
specification_name: "Pattern Learner"
specification_type: "core_engine"

pattern_categories:
  architectural_patterns:
    description: "Recurring architectural solutions and structures"
    examples:
      - "Microservice boundaries"
      - "API gateway patterns"
      - "Event sourcing implementations"
      - "CQRS structures"
      - "Layered architectures"
    recognition_features:
      - "Component relationships"
      - "Communication patterns"
      - "Data flow directions"
      - "Separation of concerns"
      - "Scalability characteristics"
    success_indicators:
      - "Low coupling metrics"
      - "High cohesion scores"
      - "Clear boundaries"
      - "Testability improvement"
      - "Performance gains"
      
  code_patterns:
    description: "Recurring code structures and implementations"
    examples:
      - "Factory patterns"
      - "Repository patterns"
      - "Observer patterns"
      - "Dependency injection"
      - "Error handling strategies"
    recognition_features:
      - "Class hierarchies"
      - "Method signatures"
      - "Interface definitions"
      - "Naming conventions"
      - "Code organization"
    success_indicators:
      - "Code reusability"
      - "Maintainability scores"
      - "Bug reduction"
      - "Development velocity"
      - "Review approval rates"
      
  workflow_patterns:
    description: "Successful agent collaboration patterns"
    examples:
      - "Parallel development streams"
      - "Sequential handoffs"
      - "Circular reviews"
      - "Hub-and-spoke coordination"
      - "Paired programming simulation"
    recognition_features:
      - "Agent interaction frequency"
      - "Dependency resolution speed"
      - "Communication patterns"
      - "Handoff efficiency"
      - "Conflict rates"
    success_indicators:
      - "Reduced blocking time"
      - "Faster completion"
      - "Fewer conflicts"
      - "Higher quality output"
      - "Better resource utilization"
      
  failure_patterns:
    description: "Recurring failure modes and anti-patterns"
    examples:
      - "Circular dependencies"
      - "Resource contention"
      - "Over-engineering"
      - "Premature optimization"
      - "Tight coupling"
    recognition_features:
      - "Error frequencies"
      - "Rollback rates"
      - "Rework indicators"
      - "Performance degradation"
      - "Complexity metrics"
    avoidance_strategies:
      - "Early detection alerts"
      - "Alternative suggestions"
      - "Preventive constraints"
      - "Automated corrections"
      - "Learning feedback loops"

pattern_recognition_config:
  data_collection:
    sources:
      code_analysis:
        - "Abstract syntax trees"
        - "Dependency graphs"
        - "Call hierarchies"
        - "Type relationships"
        - "Module structures"
        
      execution_metrics:
        - "Task completion times"
        - "Resource usage patterns"
        - "Error frequencies"
        - "Performance benchmarks"
        - "Test results"
        
      agent_behavior:
        - "Communication logs"
        - "Decision histories"
        - "State transitions"
        - "Conflict resolutions"
        - "Collaboration patterns"
        
      quality_indicators:
        - "Code review feedback"
        - "Test coverage"
        - "Bug reports"
        - "Performance metrics"
        - "Security scan results"
    
    collection_frequency:
      real_time:
        - "Agent state changes"
        - "Error occurrences"
        - "Resource conflicts"
        - "Build failures"
        
      periodic:
        - "Code quality metrics"
        - "Performance benchmarks"
        - "Test results"
        - "Coverage reports"
        
      on_completion:
        - "Final artifacts"
        - "Success metrics"
        - "Retrospective data"
        - "Lessons learned"
  
  feature_extraction:
    structural_features:
      - "Graph topology"
      - "Component counts"
      - "Dependency depth"
      - "Coupling metrics"
      - "Cohesion scores"
      
    behavioral_features:
      - "Execution sequences"
      - "Resource access patterns"
      - "Communication frequencies"
      - "Error patterns"
      - "Performance profiles"
      
    statistical_features:
      - "Mean completion times"
      - "Variance in quality"
      - "Correlation matrices"
      - "Distribution shapes"
      - "Trend indicators"
      
    temporal_features:
      - "Time series patterns"
      - "Seasonality effects"
      - "Trend components"
      - "Cycle detection"
      - "Anomaly indicators"
  
  pattern_matching:
    algorithms:
      similarity_matching:
        description: "Find similar patterns in historical data"
        methods:
          - "Cosine similarity"
          - "Euclidean distance"
          - "Jaccard index"
          - "Edit distance"
        thresholds:
          high_similarity: "0.85"
          medium_similarity: "0.65"
          low_similarity: "0.45"
          
      clustering:
        description: "Group similar patterns together"
        methods:
          - "K-means clustering"
          - "Hierarchical clustering"
          - "DBSCAN"
          - "Spectral clustering"
        parameters:
          optimal_clusters: "dynamic"
          min_cluster_size: "5"
          
      classification:
        description: "Categorize patterns into known types"
        methods:
          - "Decision trees"
          - "Random forests"
          - "Neural networks"
          - "Support vector machines"
        accuracy_targets:
          minimum: "0.80"
          preferred: "0.90"
          
      anomaly_detection:
        description: "Identify unusual patterns"
        methods:
          - "Isolation forests"
          - "One-class SVM"
          - "Autoencoder"
          - "Statistical outliers"
        sensitivity_levels:
          high: "2_sigma"
          medium: "3_sigma"
          low: "4_sigma"

success_metrics:
  quality_metrics:
    code_quality:
      metrics:
        - "Cyclomatic complexity"
        - "Code coverage"
        - "Duplication percentage"
        - "Technical debt"
        - "Maintainability index"
      targets:
        complexity: "< 10"
        coverage: "> 80%"
        duplication: "< 5%"
        debt_ratio: "< 0.05"
        maintainability: "> 70"
        
    architectural_quality:
      metrics:
        - "Coupling between objects"
        - "Depth of inheritance"
        - "Instability index"
        - "Abstractness"
        - "Component independence"
      targets:
        coupling: "< 7"
        inheritance_depth: "< 5"
        instability: "< 0.5"
        abstractness: "0.2 - 0.8"
        independence: "> 0.8"
  
  performance_metrics:
    execution_efficiency:
      metrics:
        - "Task completion time"
        - "Resource utilization"
        - "Parallelization factor"
        - "Waiting time"
        - "Throughput"
      targets:
        completion_variance: "< 20%"
        utilization: "> 70%"
        parallelization: "> 0.6"
        waiting_ratio: "< 0.15"
        throughput_improvement: "> 10%"
        
    system_performance:
      metrics:
        - "Response time"
        - "Latency"
        - "Scalability factor"
        - "Memory efficiency"
        - "CPU efficiency"
      targets:
        p95_response: "< 200ms"
        p99_latency: "< 500ms"
        linear_scalability: "> 0.8"
        memory_overhead: "< 20%"
        cpu_efficiency: "> 60%"
  
  collaboration_metrics:
    agent_coordination:
      metrics:
        - "Handoff efficiency"
        - "Communication overhead"
        - "Conflict frequency"
        - "Resolution time"
        - "Dependency satisfaction"
      targets:
        handoff_success: "> 95%"
        comm_overhead: "< 10%"
        conflicts_per_wave: "< 5"
        resolution_time: "< 30min"
        dependency_success: "> 98%"
        
    knowledge_sharing:
      metrics:
        - "Pattern reuse rate"
        - "Documentation quality"
        - "Learning curve reduction"
        - "Error repetition"
        - "Best practice adoption"
      targets:
        reuse_rate: "> 40%"
        doc_completeness: "> 85%"
        learning_improvement: "> 25%"
        error_reduction: "> 50%"
        adoption_rate: "> 70%"

learning_rates:
  adaptation_speeds:
    fast_learning:
      description: "Immediate pattern recognition"
      use_cases:
        - "Critical failures"
        - "Security issues"
        - "Performance bottlenecks"
        - "Breaking changes"
      parameters:
        weight_update: "1.0"
        threshold_adjustment: "immediate"
        pattern_activation: "single_occurrence"
        
    moderate_learning:
      description: "Balanced pattern learning"
      use_cases:
        - "Code patterns"
        - "Architecture decisions"
        - "Workflow optimizations"
        - "Quality improvements"
      parameters:
        weight_update: "0.3"
        threshold_adjustment: "gradual"
        pattern_activation: "3_occurrences"
        
    slow_learning:
      description: "Conservative pattern adoption"
      use_cases:
        - "Style preferences"
        - "Minor optimizations"
        - "Alternative approaches"
        - "Experimental features"
      parameters:
        weight_update: "0.1"
        threshold_adjustment: "conservative"
        pattern_activation: "10_occurrences"
  
  learning_curves:
    exponential:
      description: "Rapid initial learning"
      formula: "1 - e^(-λt)"
      parameters:
        lambda: "0.5"
        plateau: "0.95"
      application: "New pattern types"
      
    logarithmic:
      description: "Diminishing returns"
      formula: "log(1 + αt)"
      parameters:
        alpha: "2.0"
        max_gain: "5.0"
      application: "Pattern refinement"
      
    sigmoid:
      description: "S-curve learning"
      formula: "1 / (1 + e^(-k(t-t0)))"
      parameters:
        k: "0.3"
        t0: "10"
      application: "Complex patterns"
      
    stepped:
      description: "Discrete improvements"
      formula: "floor(t/step) * increment"
      parameters:
        step: "5"
        increment: "0.2"
      application: "Milestone-based learning"
  
  feedback_mechanisms:
    reinforcement:
      positive:
        triggers:
          - "Successful pattern application"
          - "Quality improvement"
          - "Performance gain"
          - "Conflict reduction"
        actions:
          - "Increase pattern weight"
          - "Lower activation threshold"
          - "Expand pattern matching"
          - "Share with other contexts"
          
      negative:
        triggers:
          - "Pattern failure"
          - "Quality degradation"
          - "Performance loss"
          - "Increased conflicts"
        actions:
          - "Decrease pattern weight"
          - "Raise activation threshold"
          - "Add constraints"
          - "Flag for review"
    
    continuous_improvement:
      evaluation_cycle:
        - "Pattern application"
        - "Result measurement"
        - "Success calculation"
        - "Weight adjustment"
        - "Threshold tuning"
      
      optimization_goals:
        - "Maximize success rate"
        - "Minimize false positives"
        - "Reduce learning time"
        - "Improve generalization"
        - "Enhance robustness"

pattern_storage:
  pattern_database:
    schema:
      pattern_record:
        - "pattern_id"
        - "category"
        - "description"
        - "feature_vector"
        - "success_rate"
        - "application_count"
        - "last_updated"
        - "confidence_score"
        
      pattern_instances:
        - "instance_id"
        - "pattern_id"
        - "context"
        - "application_time"
        - "outcome"
        - "metrics"
        - "agent_feedback"
        
      pattern_relationships:
        - "relationship_id"
        - "pattern_a"
        - "pattern_b"
        - "relationship_type"
        - "strength"
        - "co_occurrence_rate"
    
    indexing:
      primary_keys:
        - "pattern_id"
        - "category"
        - "success_rate"
      search_indices:
        - "feature_similarity"
        - "temporal_proximity"
        - "context_matching"
      performance_optimization:
        - "Caching frequent patterns"
        - "Precomputed similarities"
        - "Compressed features"
  
  pattern_evolution:
    versioning:
      - "Pattern mutations"
      - "Feature additions"
      - "Threshold changes"
      - "Weight updates"
      - "Constraint modifications"
      
    lifecycle:
      stages:
        - "Discovery"
        - "Validation"
        - "Adoption"
        - "Optimization"
        - "Deprecation"
      transitions:
        - "Promotion criteria"
        - "Demotion triggers"
        - "Retirement conditions"
        
    sharing_mechanisms:
      internal:
        - "Cross-wave learning"
        - "Agent knowledge transfer"
        - "Pattern inheritance"
        - "Context adaptation"
        
      external:
        - "Pattern export"
        - "Community sharing"
        - "Best practice library"
        - "Industry benchmarks"